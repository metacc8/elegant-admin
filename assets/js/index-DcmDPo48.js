
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{p as O}from"./index-EBgu0xiU.js";import{_ as q,h as k}from"./index-C85SILP8.js";import{_ as T}from"./icon.vue_vue_type_script_setup_true_lang-CXPPfzEY.js";import{d as B,b as P,i as F,a as r,c as i,F as h,aa as x,f as m,a0 as $,a1 as b,u as g,_ as U,r as C,w as I,W as N,X as R,$ as E}from"./@vue-DJ53MWs5.js";import"./vite-plugin-fake-server-4rIte7rE.js";import"./mockjs-Dd0W0IWH.js";import"./@imengyu-BQwzwvVc.js";import"./vue-CAygiDOH.js";import"./floating-vue-DjZaMi6K.js";import"./@floating-ui-Y0iFLo_g.js";import"./vue-m-message-BxJX2Zqc.js";import"./overlayscrollbars-CZjZ1Dbc.js";import"./@iconify-C4HLlXtv.js";import"./overlayscrollbars-vue-BxfA_dC8.js";import"./@headlessui-Bm2TyfRI.js";import"./mitt-DJ65BbbF.js";import"./crypto-js-RCkyKLW7.js";import"./lodash-es-l8Yk8yFo.js";import"./pinia-DmVFObHF.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-Bg2mojPD.js";import"./hotkeys-js-BfWqkGRU.js";import"./element-plus-DdTkCxgE.js";import"./@vueuse-Bz9Gvxjd.js";import"./nprogress-BdJdCxhg.js";import"./@element-plus-Ngrzdf6G.js";import"./@sxzz-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-p2P62yYc.js";import"./async-validator-CRbnkQr6.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./vue-i18n-BnGu2oZ8.js";import"./@intlify-CEEhciFb.js";import"./colord-CrBFWQzZ.js";import"./monaco-editor-PTJBK6lV.js";import"./path-browserify-DTVwunqE.js";import"./axios-DmypytPv.js";import"./string-DlSNwMlA.js";import"./vue-esign-BNnrYaMl.js";const j=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"},{label:"method",value:"method"},{label:"regexp",value:"regexp"},{label:"integer",value:"integer"},{label:"float",value:"float"},{label:"array",value:"array"},{label:"object",value:"object"},{label:"date",value:"date"},{label:"url",value:"url"},{label:"hex",value:"hex"},{label:"email",value:"email"},{label:"any",value:"any"}],D=[{label:"change",value:"change"},{label:"blur",value:"blur"}],w=["string","number","url","array","email"],M={class:"rule-item-main hover:border-primary relative m-t-2 border border-gray-200 rounded border-solid bg-white p-2 transition-all"},A={key:0,class:"m-t-2 flex first:m-0"},L={class:"elegant-attr-label",title:"校验时机"},W={class:"elegant-attr-input"},X=B({__name:"ERuleItem",props:{rule:{}},emits:["change","delete","update:rule"],setup(y,{emit:f}){const c=y,p=f,t=P({get(){return c.rule},set(e){p("update:rule",e)}}),a=F("pageManager",{}),_=P(()=>Object.entries(a.funcs.value).filter(([e,n])=>typeof n=="function").map(([e])=>({label:e,value:e}))),l=[{type:"select",label:"校验时机",model:"trigger",componentProps:{options:D,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"switch",label:"自定义规则",model:"isValidator"},{type:"select",label:"校验函数",model:"validator",show(){return!!t.value.isValidator},componentProps:{options:_.value,placeholder:"校验函数"}},{type:"select",label:"类型",model:"type",show(){return!t.value.isValidator},componentProps:{options:j,placeholder:"类型"}},{type:"input",label:"正则校验",model:"pattern",show(){return!t.value.isValidator},componentProps:{placeholder:"正则校验"}},{type:"number",label:"字段长度",model:"len",show(){return w.includes(t.value.type??"")},componentProps:{min:0,placeholder:"字段长度"}},{type:"number",label:"最小长度",model:"min",show(){return w.includes(t.value.type??"")},componentProps:{min:0,placeholder:"最小长度"}},{type:"number",label:"最大长度",model:"max",show(){return w.includes(t.value.type??"")},componentProps:{min:0,placeholder:"最大长度"}},{type:"input",label:"校验信息",model:"message",componentProps:{placeholder:"校验信息"}}];function V(){const e=t.value;e.isValidator?(delete e.type,delete e.pattern,delete e.len,delete e.min,delete e.max):delete e.validator,p("change",e)}function d(){p("delete")}return(e,n)=>(r(),i("div",M,[(r(),i(h,null,x(l,(o,u)=>(r(),i(h,{key:u},[!o.show||o.show()?(r(),i("div",A,[m("div",L,$(o.label),1),m("div",W,[b(g(q),{modelValue:t.value[o.model],"onUpdate:modelValue":s=>t.value[o.model]=s,"component-schema":{...o,noFormItem:!0},onChange:V},null,8,["modelValue","onUpdate:modelValue","component-schema"])])])):U("",!0)],64))),64)),m("div",{class:"rule-btn-delete absolute right-0 top-0 h-24px w-24px flex cursor-pointer items-center justify-center rounded-bl-2 color-white transition-all",onClick:d},[b(g(T),{name:"icon-shanchu1"})])]))}}),z={class:"rule-item-main relative m-t-2 border rounded border-solid p-2 transition-all"},G={key:0,class:"m-t-2 flex first:m-0"},H={class:"elegant-attr-label"},J={class:"flex-1"},Fe=B({__name:"index",props:{ruleType:{type:String,default:"string"},modelValue:{type:Array,default:void 0}},emits:["update:modelValue"],setup(y,{emit:f}){const c=y,p=f,t=O.getComponent("button"),a=C({required:!1,message:"必填项",type:c.ruleType,trigger:["change"]}),_=[{type:"switch",label:"必填项",model:"required"},{type:"select",label:"校验时机",model:"trigger",show(){return!!a.value.required},componentProps:{options:D,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"select",label:"类型",model:"type",show(){return!!a.value.required},componentProps:{options:j,placeholder:"类型"}},{type:"input",label:"校验信息",model:"message",show(){return!!a.value.required},componentProps:{placeholder:"校验信息"}}],l=C([]);I(()=>c.modelValue,n=>{if(n){if(!n)return;l.value=[],n.forEach(o=>{typeof o.required<"u"?a.value=o:l.value.push(o)})}},{immediate:!0});function V(){l.value.push({message:"",type:c.ruleType,trigger:["change"]}),d()}function d(){if(a.value.required){p("update:modelValue",k([...l.value,a.value]));return}if(l.value.length){p("update:modelValue",k(l.value));return}p("update:modelValue",void 0)}function e(n){l.value.splice(n,1),d()}return(n,o)=>(r(),i("div",null,[m("div",z,[(r(),i(h,null,x(_,(u,s)=>(r(),i(h,{key:s},[!u.show||u.show()?(r(),i("div",G,[m("div",H,$(u.label),1),m("div",J,[b(g(q),{modelValue:a.value[u.model],"onUpdate:modelValue":v=>a.value[u.model]=v,"component-schema":{...u,noFormItem:!0},onChange:d},null,8,["modelValue","onUpdate:modelValue","component-schema"])])])):U("",!0)],64))),64))]),(r(!0),i(h,null,x(l.value,(u,s)=>(r(),N(X,{key:s,rule:l.value[s],"onUpdate:rule":v=>l.value[s]=v,onDelete:v=>e(s),onChange:d},null,8,["rule","onUpdate:rule","onDelete"]))),128)),b(g(t),{class:"m-t-2",onClick:V},{default:R(()=>[E(" 添加规则 ")]),_:1})]))}});export{Fe as default};


/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{d as V,r as E,i as g,b as B,a as u,c as k,f as C,m as S,a1 as b,u as i,_ as U,W as T,j as w,X as $,U as L,F as M,aa as z,V as F,p as _,Y as H,a2 as W}from"./@vue-DJ53MWs5.js";import{p as N}from"./index-CF0Df7v0.js";import{_ as j}from"./icon.vue_vue_type_script_setup_true_lang-CXPPfzEY.js";import{d as X}from"./vuedraggable-Ce-5l_FJ.js";const D=V({name:"ETreeNodeItem",__name:"treeNodeItem",props:{schema:{}},setup(y){const a=y,d=E({...a.schema}),p=g("slots",{}),c=g("expandedKeys"),v=g("treeProps"),l=g("selectedKeys"),x=g("handleSelect"),m=B(()=>c.value.includes(a.schema.id??"")),o=V({setup(){return()=>{var s;return w("span",{class:{text:!0,hover:v.hoverKey===a.schema.id,checked:l.value.includes(a.schema.id)},onClick:()=>x(a.schema.id,a.schema)},((s=p["tree-node"])==null?void 0:s.call(p,a))??w("span",{class:"elegant-text-padding"},{default:()=>{var e;return[a.schema.label??((e=N.getComponentConfingByType(a.schema.type))==null?void 0:e.defaultSchema.label),w("span",{class:"elegant-node-type-text"},a.schema.type)]}}))}}});function r(){const s=a.schema.id;if(!s)return!1;c.value.includes(s)?c.value=c.value.filter(e=>e!==s):c.value.push(s)}function f(){var e;const s=a.schema.id;if(!s||!((e=a.schema.children)!=null&&e.length))return!1;c.value.push(s)}return f(),(s,e)=>{var n,t,h;return u(),k("li",{class:S(["elegant-tree-node",{expanded:(n=a.schema.children)==null?void 0:n.length,"level-1":a.schema.type==="page"}])},[C("a",null,[(t=a.schema.children)!=null&&t.length&&a.schema.type!=="page"?(u(),k("span",{key:0,class:S(["icon-expanded",{expanded:m.value}]),onClick:r},[b(i(j),{name:"icon-youjiantou"})],2)):U("",!0),b(i(o))]),(h=a.schema.children)!=null&&h.length?(u(),T(A,{key:0,schemas:i(d).children,"onUpdate:schemas":e[0]||(e[0]=K=>i(d).children=K),class:S(["elegant-tree-sublist",{expanded:m.value}]),"parent-schema":a.schema},null,8,["schemas","class","parent-schema"])):U("",!0)],2)}}}),Y={key:1},A=V({name:"ETreeNodes",__name:"treeNodes",props:{schemas:{},parentSchema:{}},emits:["update:schemas"],setup(y,{emit:a}){const d=y,p=a,c=g("design"),v=g("treeProps"),l=B({get(){return d.schemas},set(o){p("update:schemas",o)}});function x(o){c.setDisableHover(!0),c.setCheckedNode(l.value[o])}function m(o){var r;return o.type==="page"||(r=N.getComponentConfingByType(o.type).editConstraints)!=null&&r.immovable?"unmover-item":"draggable-item"}return(o,r)=>{var f,s,e,n;return(e=(s=i(N).getComponentConfingByType(((f=d.parentSchema)==null?void 0:f.type)||""))==null?void 0:s.editConstraints)!=null&&e.childImmovable?(u(),k("ul",Y,[(u(!0),k(M,null,z(l.value,t=>(u(),T(D,{key:t.id,schema:t},null,8,["schema"]))),128))])):(u(),T(i(X),L({key:0,modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=t=>l.value=t),"item-key":"id","component-data":{},class:"elegant-draggable-range"},{animation:200,tag:"ul",group:"tree-draggable",ghostClass:"moveing",draggable:".draggable-item",disabled:!i(v).draggable||((n=l.value[0])==null?void 0:n.type)==="page"},{onStart:r[1]||(r[1]=t=>x(t.oldIndex))}),{item:$(({element:t,index:h})=>[(u(),T(D,{key:h,class:S(m(t)),schema:t},null,8,["class","schema"]))]),_:1},16,["modelValue"]))}}}),q={class:"elegant-tree h-full flex flex-col"},G={class:"elegant-search-box px-10px py-6px"},J={class:"elegant-tree-main h-0 flex-1 overflow-auto"},O={class:"pt-42px text-center text-gray-400"},ae=V({name:"ETree",__name:"tree",props:{options:{type:Array,default:()=>[]},hoverKey:{type:String,default:""},selectedKeys:{type:Array,default:()=>[]},draggable:{type:Boolean,default:!1}},emits:["update:selectedKeys","nodeClick"],setup(y,{emit:a}){const d=y,p=a,c=F();_("slots",c);const v=N.getComponent("input"),l=E(""),x=E([]),m=B({get(){return d.selectedKeys},set(s){p("update:selectedKeys",s)}}),o=B(()=>r(d.options,l.value));function r(s,e){const n=[];return s.forEach(t=>{var h,K;if((h=t.label)!=null&&h.includes(e))n.push(t);else if((K=t==null?void 0:t.children)!=null&&K.length){const I=r(t.children,e);if(I.length>0){const P={...t};P.children=I,n.push(P)}}}),n}function f(s,e){m.value=[s],p("nodeClick",{id:s,componentSchema:e})}return _("expandedKeys",x),_("selectedKeys",m),_("treeProps",d),_("handleSelect",f),(s,e)=>(u(),k("div",q,[C("div",G,[b(i(v),{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=n=>l.value=n),value:l.value,"onUpdate:value":e[1]||(e[1]=n=>l.value=n),placeholder:"搜索节点",clearable:"","allow-clear":""},{prefix:$(()=>[b(i(j),{name:"icon-chaxun"})]),_:1},8,["modelValue","value"])]),C("div",J,[C("ul",null,[b(A,{schemas:o.value,"onUpdate:schemas":e[2]||(e[2]=n=>o.value=n)},null,8,["schemas"])]),H(C("div",O," 没有查询到的数据 ",512),[[W,!o.value.length]])])]))}});export{ae as _};

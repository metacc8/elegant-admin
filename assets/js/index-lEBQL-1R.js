
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{_ as j}from"./index-DR4x_9r6.js";import{d as N,bi as g,bF as O,r as P,aj as r,a as p,c as m,a1 as t,X as f,W as v,S as c,f as i,a8 as w,Y as A,u as h,a2 as D,_}from"./@vue-DJ53MWs5.js";import{a as y}from"./element-plus-DdTkCxgE.js";import{_ as L}from"./vue-esign-BNnrYaMl.js";const R={class:"upload-container"},F={key:1,class:"image"},T={class:"mask"},W={class:"actions"},X={key:0,class:"el-upload__tip"},Y={style:{display:"inline-block"}},q=N({name:"ImageUpload",__name:"index",props:g({action:{},headers:{},data:{},name:{default:"file"},size:{default:2},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]}},{modelValue:{default:""},modelModifiers:{}}),emits:g(["onSuccess"],["update:modelValue"]),setup(u,{emit:$}){const d=u,V=$,o=O(u,"modelValue"),s=P({imageViewerVisible:!1,progress:{preview:"",percent:0}});function b(){s.value.imageViewerVisible=!0}function k(){s.value.imageViewerVisible=!1}function E(){o.value=""}const z=e=>{const l=e.name.split(".").at(-1)??"",a=d.ext.includes(l),n=e.size/1024/1024<d.size;return a||y.error(`上传图片只支持 ${d.ext.join(" / ")} 格式！`),n||y.error(`上传图片大小不能超过 ${d.size}MB！`),a&&n&&(s.value.progress.preview=URL.createObjectURL(e)),a&&n},C=e=>{s.value.progress.percent=~~e.percent},M=e=>{s.value.progress.preview="",s.value.progress.percent=0,V("onSuccess",e)};return(e,S)=>{const l=j,a=r("ElImage"),n=r("ElProgress"),B=r("ElUpload"),I=r("ElAlert"),U=r("ElImageViewer");return p(),m("div",R,[t(B,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":z,"on-progress":C,"on-success":M,drag:"",class:"image-upload"},{default:f(()=>[o.value===""?(p(),v(a,{key:0,src:o.value===""?e.placeholder:o.value,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},{error:f(()=>[i("div",{class:"image-slot",style:c(`width:${e.width}px;height:${e.height}px;`)},[t(l,{name:"ep:plus",class:"icon"})],4)]),_:1},8,["src","style"])):(p(),m("div",F,[t(a,{src:o.value,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),i("div",T,[i("div",W,[i("span",{title:"预览",onClick:w(b,["stop"])},[t(l,{name:"ep:zoom-in",class:"icon"})]),i("span",{title:"移除",onClick:w(E,["stop"])},[t(l,{name:"ep:delete",class:"icon"})])])])])),A(i("div",{class:"progress",style:c(`width:${e.width}px;height:${e.height}px;`)},[t(a,{src:h(s).progress.preview,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),t(n,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:h(s).progress.percent},null,8,["width","percentage"])],4),[[D,o.value===""&&h(s).progress.percent]])]),_:1},8,["headers","action","data","name"]),e.notip?_("",!0):(p(),m("div",X,[i("div",Y,[t(I,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，且图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),h(s).imageViewerVisible?(p(),v(U,{key:1,"url-list":[o.value],teleported:"",onClose:k},null,8,["url-list"])):_("",!0)])}}}),Q=L(q,[["__scopeId","data-v-eb8db6d9"]]);export{Q as _};

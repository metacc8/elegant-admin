
/**
 * 由 MrZhang 提供技术支持
 * Powered by elegant-admin
 * Github https://github.com/zhangyao1990/elegant-admin
 */

import{d as V,r as E,w as A,i as m,b as B,a as u,c as k,f as C,m as S,a1 as b,u as h,_ as P,W as T,j as w,X as D,U as L,F as z,aa as F,V as H,p as _,Y as M,a2 as W}from"./@vue-DJ53MWs5.js";import{p as N}from"./index-DR4x_9r6.js";import{_ as $}from"./icon.vue_vue_type_script_setup_true_lang-CXPPfzEY.js";import{d as X}from"./vuedraggable-Ce-5l_FJ.js";const U=V({name:"ETreeNodeItem",__name:"treeNodeItem",props:{schema:{}},setup(f){const t=f,d=E(t.schema);A(()=>t.schema,e=>{d.value=e},{deep:!0});const i=m("slots",{}),c=m("expandedKeys"),y=m("treeProps"),l=m("selectedKeys"),v=m("handleSelect"),p=B(()=>c.value.includes(t.schema.id??"")),o=V({setup(){return()=>{var e;return w("span",{class:{text:!0,hover:y.hoverKey===t.schema.id,checked:l.value.includes(t.schema.id)},onClick:()=>v(t.schema.id,t.schema)},((e=i["tree-node"])==null?void 0:e.call(i,t))??w("span",{class:"elegant-text-padding"},{default:()=>{var a;return[t.schema.label??((a=N.getComponentConfingByType(t.schema.type))==null?void 0:a.defaultSchema.label),w("span",{class:"elegant-node-type-text"},t.schema.type)]}}))}}});function r(){const e=t.schema.id;if(!e)return!1;c.value.includes(e)?c.value=c.value.filter(a=>a!==e):c.value.push(e)}function g(){var a;const e=t.schema.id;if(!e||!((a=t.schema.children)!=null&&a.length))return!1;c.value.push(e)}return g(),(e,a)=>{var n,s,x;return u(),k("li",{class:S(["elegant-tree-node",{expanded:(n=t.schema.children)==null?void 0:n.length,"level-1":t.schema.type==="page"}])},[C("a",null,[(s=t.schema.children)!=null&&s.length&&t.schema.type!=="page"?(u(),k("span",{key:0,class:S(["icon-expanded",{expanded:p.value}]),onClick:r},[b(h($),{name:"icon-youjiantou"})],2)):P("",!0),b(h(o))]),(x=t.schema.children)!=null&&x.length?(u(),T(j,{key:0,schemas:d.value.children,"onUpdate:schemas":a[0]||(a[0]=K=>d.value.children=K),class:S(["elegant-tree-sublist",{expanded:p.value}]),"parent-schema":t.schema},null,8,["schemas","class","parent-schema"])):P("",!0)],2)}}}),Y={key:1},j=V({name:"ETreeNodes",__name:"treeNodes",props:{schemas:{},parentSchema:{}},emits:["update:schemas"],setup(f,{emit:t}){const d=f,i=t,c=m("designer"),y=m("treeProps"),l=B({get(){return d.schemas},set(o){i("update:schemas",o)}});function v(o){c.setDisableHover(!0),c.setCheckedNode(l.value[o])}function p(o){var r;return o.type==="page"||(r=N.getComponentConfingByType(o.type).editConstraints)!=null&&r.immovable?"unmover-item":"draggable-item"}return(o,r)=>{var g,e,a,n;return(a=(e=h(N).getComponentConfingByType(((g=d.parentSchema)==null?void 0:g.type)||""))==null?void 0:e.editConstraints)!=null&&a.childImmovable?(u(),k("ul",Y,[(u(!0),k(z,null,F(l.value,s=>(u(),T(U,{key:s.id,schema:s},null,8,["schema"]))),128))])):(u(),T(h(X),L({key:0,modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=s=>l.value=s),"item-key":"id","component-data":{},class:"elegant-draggable-range"},{animation:200,tag:"ul",group:"tree-draggable",ghostClass:"moveing",draggable:".draggable-item",disabled:!h(y).draggable||((n=l.value[0])==null?void 0:n.type)==="page"},{onStart:r[1]||(r[1]=s=>v(s.oldIndex))}),{item:D(({element:s})=>[(u(),T(U,{key:s.id,class:S(p(s)),schema:s},null,8,["class","schema"]))]),_:1},16,["modelValue"]))}}}),q={class:"elegant-tree h-full flex flex-col"},G={class:"elegant-search-box px-10px py-6px"},J={class:"elegant-tree-main h-0 flex-1 overflow-auto"},O={class:"pt-42px text-center text-gray-400"},ae=V({name:"ETree",__name:"tree",props:{options:{type:Array,default:()=>[]},hoverKey:{type:String,default:""},selectedKeys:{type:Array,default:()=>[]},draggable:{type:Boolean,default:!1}},emits:["update:selectedKeys","nodeClick"],setup(f,{emit:t}){const d=f,i=t,c=H();_("slots",c);const y=N.getComponent("input"),l=E(""),v=E([]),p=B({get(){return d.selectedKeys},set(e){i("update:selectedKeys",e)}}),o=B({get(){return r(d.options,l.value)},set(e){}});function r(e,a){const n=[];return e.forEach(s=>{var x;if((x=s.label)!=null&&x.includes(a))n.push(s);else if(s.children){const K=r(s.children,a);if(K.length>0){const I={...s};I.children=K,n.push(I)}}}),n}function g(e,a){p.value=[e],i("nodeClick",{id:e,componentSchema:a})}return _("expandedKeys",v),_("selectedKeys",p),_("treeProps",d),_("handleSelect",g),(e,a)=>(u(),k("div",q,[C("div",G,[b(h(y),{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=n=>l.value=n),value:l.value,"onUpdate:value":a[1]||(a[1]=n=>l.value=n),placeholder:"搜索节点",clearable:"","allow-clear":""},{prefix:D(()=>[b(h($),{name:"icon-chaxun"})]),_:1},8,["modelValue","value"])]),C("div",J,[C("ul",null,[b(j,{schemas:o.value,"onUpdate:schemas":a[2]||(a[2]=n=>o.value=n)},null,8,["schemas"])]),M(C("div",O," 没有查询到的数据 ",512),[[W,!o.value.length]])])]))}});export{ae as _};
